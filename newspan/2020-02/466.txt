Middle East|Was U.S. Wrong About Attack That Nearly Started a War With Iran?
 Soon there was a flash and a ripping sound as the first of the rockets fired from the truck soared toward Iraq’s K-1 military base.
The Islamic State, however, had carried out three attacks relatively close to the base in the 10 days before the attack on K-1. Iraqi intelligence officials sent reports to the Americans in November and December warning that ISIS intended to target K-1, an Iraqi air base in Kirkuk Province that is also used by American forces.
And the abandoned Kia pickup was found was less than 1,000 feet from the site of an ISIS execution in September of five Shiite buffalo herders.
“All the indications are that it was Daesh,” said Brig. General Ahmed Adnan, the Iraqi chief of intelligence for the federal police at K-1, using the Arabic acronym for the Islamic State. “I told you about the three incidents in the days just before in the area — we know Daesh’s movements.
Khataib Hezbollah has denied responsibility for the attack, and no group has claimed it.
American officials, however, said they had multiple strands of intelligence indicating that Khataib Hezbollah carried it out.
American investigators examined the Kia pickup, which yielded evidence that helped attribute the attack to Khataib Hezbollah, two American officials said, speaking on condition of anonymity to discuss intelligence matters. They did not say what about the truck connected it to the group.
One American official said they also had intercepted communications showing the group’s involvement.
The American officials said that there had been 11 rocket attacks in November and December against Iraqi bases used by American or coalition forces. One official said that for more than half of those attacks, including the Dec. 27 attack, the United States had high confidence that Khataib Hezbollah was responsible.
The United States has not presented any of its intelligence publicly. Nor has it shared the intelligence with Iraq.
“We have requested the American side to share with us any information, any evidence, but they have not sent us any information,” Lt. Gen. Muhammad al-Bayati, the chief of staff for former Prime Minister Adel Abdul Mahdi, said in an interview.
The director general of Iraqi Intelligence and Counterterrorism, Abu Ali al-Basri, said the United States did not consult Iraq before carrying out the Dec. 29 counterattacks on Khataib Hezbollah.
Despite the fact that American and Iraqi forces work side by side on counterterrorism, American intelligence and defense officials said that the United States does not always share sensitive intelligence with Iraq because Iranian operatives have penetrated the Baghdad government and will feed intelligence to Tehran.
Iraqi intelligence officials said it was difficult to assess the American assertions without seeing the American intelligence.
They said they saw nothing unusual about the truck or the rockets used in the Dec. 27 attack that would have connected them to Khataib Hezbollah. The truck was a standard Kia pickup, except that its bed had been fitted with rocket launchers, they said. The rockets — 107 mm katyushas — are used by all sides in Iraq.
General Adnan said he delivered the truck to the Americans, and that American investigators removed any rocket fragments and one unexploded rocket from the Iraqi side of the base, so it would be difficult for the Iraqis to conduct a deeper forensic investigation of their own.
One discrepancy in the intelligence concerns the number of rockets fired. The Americans said that 31 rockets were fired.
Iraqi witnesses, including General Adnan, who was the first to reach the truck, counted 11.
Several Iraqi officers on the K-1 base thought there might have been as many as 16 but definitely not 31.
Ali Farhan, a farmer and the mayor of Neptis, a tiny village about four miles from K-1 and barely a mile from the launch site, said he happened to be outside talking to his brother about the next morning’s plowing when he saw a truck coming from the southwest — territory friendly to the Islamic State. The truck veered onto a dirt track, went another half mile or so, stopped and turned off its lights.
About 35 minutes later, at 7:20 p.m., he saw the first rocket arc into the sky. So did General Adnan, whom the mayor had called for help and who was driving as fast as he could on the dirt road toward the truck to stop it.
“I immediately called headquarters and warned them that rockets had begun to launch toward our base,” General Adnan recalled.
When he reached the truck, he found that the attack could have been worse. There were three racks of 12 launchers, but fewer than half appeared to have had rockets in them and of those four had failed to launch. That would mean a maximum of 14 rockets were fired.
An intelligence brief sent to United States officials on Dec. 25 said that Islamic State fighters were trying to gain ground northwest of K-1.
General Adnan said he had warned the Americans about the possibility of a rocket attack on K-1 as recently as lunch the day of the attack when the Iraqis had invited the American commanders at the base for security talks over chicken tikka, rice and kebabs.
One Iraqi Federal Police commander, Col. Talib Madhloum al-Tamimi, said he had beseeched the Americans to keep their reconnaissance balloon in the air to help prevent an attack, but the balloon was down that day for maintenance, he said.
General Adnan said three rockets fell on the Iraqi side of the K-1 base, one on the perimeter fence and about seven on the American side. At least one hit a munitions store on the American side, causing a large secondary explosion.
Unlike most of the attacks against Iraqi and American targets, this one had casualties. Four American soldiers and two Iraqi federal police officers were wounded. The civilian contractor who was killed, an Iraqi-born American named Nawres Waleed Hamid, was working as an interpreter for the Americans.
The Islamic State has been increasingly active in this part of Kirkuk Province in the past year, carrying out near daily attacks with roadside bombs and ambushes using small arms.
When American officials informed the Iraqi prime minister they were about to bomb Khataib Hezbollah bases in retaliation, the Iraqis were startled.
Iraqi officials said the group had not had a presence in Kirkuk Province in years. The only time it was active there, they said, was in 2014 during the early days of the fight against the Islamic State.
Muhammad Muhi, the spokesman for Khataib Hezbollah, denied that the militia was responsible for the attack on K-1. The group was only in Kirkuk Province for 80 days in 2014, he said in an interview.
American officials said that the group has operated throughout Iraq, and has routinely conducted attacks in Sunni territory.
The American attacks on Khataib Hezbollah on Jan. 2 and the drone attack that killed the Iranian and Iraqi military leaders at the Baghdad airport the next day led to widespread anger against the American presence in Iraq and a vote in Iraq’s Parliament to expel all American forces.
The United States has about 5,000 troops in Iraq, whose primary mission is fighting the Islamic State and training the Iraqi military. The Iraqi government has not yet formally asked the Americans to leave but officials on both sides report that relations have been strained.
Iraqi officials say many unanswered questions remain about who was responsible for the K-1 attack.
Julian E. Barnes and Eric Schmitt contributed reporting from Washington, and Falih Hassan from Baghdad.