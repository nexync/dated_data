MADRID — Roger Federer’s return to clay lasted only three matches.
A day after saving two match points at the Madrid Open, Federer squandered two match points himself in the quarterfinals against Dominic Thiem on Friday, losing, 3-6, 7-6 (11), 6-4.
It may have ended his first appearance at a clay-court tournament in three years, but Federer was not overly disappointed with the outcome.
Federer had skipped the clay seasons the past two years to remain fit for the rest of the season. He decided to return this year in preparation for his first French Open appearance since 2015.
The fifth-seeded Thiem, the runner-up in Madrid the last two seasons, will next face top-ranked Novak Djokovic, who did not have to play his quarterfinal after Marin Cilic withdrew because of food poisoning.
Thiem has a chance to win his third title of the year after victories in Barcelona and in Indian Wells, Calif., where he defeated Federer in a three-set final.
The other semifinal will be between Stefanos Tsitsipas and the five-time Madrid champion Rafael Nadal. Tsitsipas defeated the defending champion, Alexander Zverev, 7-5, 3-6, 6-2, while Nadal cruised past Stan Wawrinka, 6-1, 6-2.
Nadal lost only seven points on his service games, conceding no break opportunities against the 34th-ranked Wawrinka, who lost the 2013 Madrid final to Nadal.
On the women’s side, Simona Halep made it back to the Madrid final for the first time since 2017 with a 6-2, 6-7 (2), 6-0 victory over unseeded Belinda Bencic.
The French Open champion can surpass Naomi Osaka for the No. 1 ranking if she wins Saturday’s final.

Federer, 37, was trying to win his third Madrid title, and his first since 2012. He has already won hardcourt titles this season in Dubai, United Arab Emirates, and in Miami.
Federer got off to a great start against Thiem at the Magic Box center court, breaking Thiem’s serve early and cruising to a first-set win. He squandered five break points in the second set and then had match points at 8-7 and 10-9 in the tiebreaker before Thiem forced the deciding set by converting his sixth set point.
Federer had saved two match points in his difficult three-set win over Gaël Monfils on Thursday.
Thiem broke Federer for the first time in the third game of the third set, converting his ninth break opportunity of the match. Federer got back on serve at 4-4 but started his next game 0-40 and could not recover. Thiem then served out for the victory, converting on his second match point.
Thiem has won the last two matches he played against Djokovic, who had the day off because of Cilic’s withdrawal.
The top-seeded Djokovic is seeking a third Madrid Open title and his second title of the season after winning the Australian Open.
Thiem lost the Madrid final to Nadal in 2017 and to Alexander Zverev in 2018.
