A major insider trading case against the Las Vegas sports bettor William T. Walters is in danger of unraveling, after it was revealed that a federal agent leaked confidential information to reporters.
At a hearing on Wednesday, the judge in the case excoriated the agent for his role in the leaks and essentially instructed Mr. Walters’s lawyers to file a motion to dismiss the case.
“To say I was shocked would be an accurate statement,” Judge P. Kevin Castel of Federal District Court in Manhattan said of the leaks.
Mr. Walters was charged in May with using illegal stock tips to help generate some $40 million in profits and avoid losses in one of the most prominent insider trading cases brought by Preet Bharara, the United States attorney for the Southern District of New York.
A dismissal would represent a significant blow to Mr. Bharara’s efforts to revive vigorous insider trading prosecutions two years after an appeals court overturned the convictions of two hedge fund managers and imposed stringent limits on prosecutors.
The case against Mr. Walters has been marred by revelations this month that a special agent for the Federal Bureau of Investigation leaked details of the inquiry to reporters at The Wall Street Journal and The New York Times two years before Mr. Walters was indicted.
That agent has told federal prosecutors that he was a “significant source of confidential information” for the reporters, who produced articles about the investigation in 2014.
The agent, who has not been publicly identified, faces a criminal investigation by the Justice Department’s Office of Inspector General, prosecutors said at the court hearing on Wednesday.
Mr. Walters’s lawyer, Barry H. Berke, said the agent’s motive in leaking information was to thrust the case into the public eye to help jump-start an investigation that had stalled.
He called on the federal authorities to investigate whether the agent might have been involved in press leaks related to other insider trading cases.
“Did anyone in the U.S. attorney’s office ask, ‘Do we have rogue agents?’” Mr. Berke said.
The potential collapse of the case is a troubling development for the news media, which relies on cultivating sources within law enforcement agencies to help expose wrongdoing. A criminal prosecution of an F.B.I. agent could make those in law enforcement less likely to work with the press.
The authorities have said illegal stock tips from Thomas C. Davis, a former chairman of Dean Foods, helped Mr. Walters generate millions in profits while avoiding losses. Mr. Davis agreed to plead guilty and cooperate with the investigation.
The investigation was notable in part because it also involved the champion golfer Phil Mickelson. Mr. Mickelson was not criminally charged, but the Securities and Exchange Commission cited him in a lawsuit against Mr. Walters, saying he traded in Dean Foods stock on Mr. Walters’s recommendation. Mr. Mickelson agreed to repay nearly $1 million in profits.
The special agent first disclosed information about the case to reporters at The Times over dinner in April 2013, when he believed that the “investigation was dormant,” according to a court document filed by the United States attorney’s office that detailed its inquiry into the leaks.
In May 2014, the special agent and other F.B.I. representatives met with reporters and an editor at The Journal.
The special agent told prosecutors that the F.B.I. was trying at the time to persuade The Journal to hold off on publishing an article and was willing to provide it with certain details about the investigation. Other F.B.I. officials told prosecutors the agency had not shared anything with the paper.
But the F.B.I. told their Journal contacts that The Times was working on its own story about the case — setting off the publication of the first articles about the investigation.
At first, Judge Castel said he was skeptical when Mr. Walters’s lawyers raised concerns that the leaks might have muddied the investigation.
But upon learning of the steps the special agent had taken to relay information to reporters — in numerous phone calls and meetings over dinner and coffee — the judge said he changed his mind. “I wasn’t cynical enough,’’ he said.
A lawyer for the F.B.I. agent has asked that the judge keep his client’s name secret because of “medical concerns.” Judge Castel said he had asked the lawyer to submit “medical evidence” by month’s end as to why the agent’s identity should continue to be kept out of the court record.
If the criminal charges against Mr. Walters are dismissed, it would be another stunning legal victory for him. He has faced charges before — mostly arising from his gambling business — yet he was not convicted.