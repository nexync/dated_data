WASHINGTON — At the start of Donald Trump’s presidency, American intelligence agencies told the new administration that while North Korea had built the bomb, there was still ample time — upward of four years — to slow or stop its development of a missile capable of hitting an American city with a nuclear warhead.
The North’s young leader, Kim Jong-un, faced a range of troubles, they assured the new administration, giving Mr. Trump time to explore negotiations or pursue countermeasures. One official who participated in the early policy reviews said estimates suggested Mr. Kim would be unable to strike the continental United States until 2020, perhaps even 2022.
And on the first Sunday in September, he detonated a sixth nuclear bomb. After early hesitation among analysts, a consensus has now emerged that it was the North’s first successful test of a hydrogen weapon, with explosive force some 15 times greater than the atom bomb that leveled Hiroshima.
The C.I.A. and other American intelligence services had predicted this moment would come, eventually. For decades, they accurately projected the broad trajectory of North Korea’s nuclear program. Yet their inability to foresee the North’s rapid strides over the past several months now ranks among America’s most significant intelligence failures, current and former officials said in recent interviews.
That disconnect — they saw it coming, but got the timing wrong — helps explain the confusion, mixed signals and alarm that have defined how Mr. Trump’s untested national security team has responded to the nuclear crisis.
Senior intelligence officials said they began investing more heavily in acquiring information on North Korea’s weapons program in 2012, reaping benefits over the past two years. But they acknowledged they made two key assumptions that proved wrong.
They assumed that North Korea would need about as much time to solve the rocket science as other nations did during the Cold War, underestimating its access to both advanced computer modeling and foreign expertise. They also misjudged Mr. Kim, 33, who took control of the dynastic regime in late 2011 and made the weapons program more of a priority than his father or grandfather did.
Mr. Obama warned Mr. Trump during the transition a year ago that North Korea would pose the most urgent national security threat, and almost immediately the newly installed president began repeating, publicly and privately, that he inherited “a mess” in North Korea because his predecessors did not do enough.
Former officials in the Obama administration dispute that. But some concede that the intelligence community’s flawed assessment of the North’s progress meant there was less pressure to bolster missile defenses, more vigorously enforce sanctions or consider stepped-up covert action.
It is not clear that even with more advanced warning the Obama or Trump administrations would have been able to slow Mr. Kim’s progress.
Over many years, the North Koreans have outmaneuvered several American presidents — Republicans and Democrats alike — with technological advances that seemed highly threatening but not worth the risk of a war that could kill millions in South Korea and Japan. A beefed-up military presence off the North Korean coast, cyberattacks, sabotage of imported parts and simulated bombing runs may have slowed but ultimately failed to stop the country’s nuclear program.
Now, facing the biggest advances of all, Mr. Trump faces the same dilemma his predecessors did, but with less time to respond.
And the shakiness of intelligence on North Korea — even on fundamental questions like how many nuclear weapons Mr. Kim possesses — casts a shadow over Mr. Trump’s options going forward.
He has repeatedly raised the prospect of war with North Korea. He has also ordered up a range of new military plans, from a limited “punch in the nose” to signal American resolve to a large-scale attack aimed at destroying the country’s nuclear and missile facilities — all of which, his aides worry, could trigger a devastating wider conflict.
Yet many in the Pentagon see the failure to anticipate the North’s recent breakthroughs as an ominous reminder of how much could go wrong. A successful pre-emptive strike, for example, might require precise knowledge of the locations of manufacturing facilities, nuclear plants and storage areas, and confidence that cyberstrikes and electronic strikes would cripple Mr. Kim’s ability to retaliate.
The past year, one senior administration official said, had been a “humbling lesson” in the limits of American electronic, satellite and human intelligence operations against a sealed-off society with few computer networks, a high degree of paranoia about American covert action, and a determined young leader.
The North’s rapid progress raises a number of awkward questions: Did the American sabotage effort, for example, prompt Mr. Kim to scrap an ailing missile program for a new generation of more capable rocket engines? Or was that his plan all along? And does the new program have similar vulnerabilities the United States can exploit?
During a talk last fall, Gen. John E. Hyten, who heads the United States Strategic Command, which controls the American nuclear arsenal, acknowledged he had no idea when North Korea would pass its final technological hurdle: proving its warheads can survive fiery re-entry into the atmosphere to hit targets in the United States.
Ever since the United States began tracking North Korea’s efforts to obtain a nuclear weapon, a pattern has repeated itself: American intelligence agencies excelled at forecasting the direction and overall timeline of the program, yet repeatedly missed critical turns.
Recently declassified documents show the C.I.A. recognized the North’s ambitions in the early 1980s, when spy satellites first spotted evidence that it was building a reactor to produce plutonium, a main fuel for nuclear arms. A division of the agency immersed itself in studying the North’s factories and reactors, trying to gauge how fast the backward state could build advanced rocket engines, specialty fuels and nuclear warheads.
After the collapse of the Soviet Union, waves of its impoverished missile scientists began to head for North Korea. While Russian security forces intercepted some, others made it out or assisted the North from afar. In retrospect, former American intelligence officials say they almost certainly missed significant transfers of technology.
“These are designs you can put on a thumb drive,” said a senior official who has tracked North Korea for years and spoke on condition of anonymity because of the topic’s sensitivity.
The missiles Mr. Kim has launched in recent months bear numerous signs of Soviet provenance. But analysts and intelligence officials say the specific dates, places and means of transfer remain murky.
Ostensibly, North Korea suspended its nuclear weapons program in 1994 after a tense standoff with the United States that brought the two countries closer than ever — until recent months — to resuming the Korean War. With the Clinton administration weighing military options, former President Jimmy Carter negotiated a deal that ultimately resulted in a freeze of the North’s nuclear program in exchange for fuel oil and the construction of nuclear power plants, which ultimately were never built.
That deal appeared to hold for six years but, in fact, the North began cheating on the agreement within a few years. Secretly, it was pursuing an alternative path to the bomb using uranium fuel.
The intelligence community eventually spotted shipments from Russia and Pakistan containing parts for centrifuges used to enrich uranium. Confronted with the evidence, North Korea acknowledged the program, prompting the Bush administration to suspend the agreement. But the North pressed ahead, and today analysts believe it uses uranium for many of its new warheads.
From as early as 2000, the National Intelligence Council was remarkably prescient about North Korea’s overall direction, predicting in an unclassified report that it would “most likely” have a nuclear missile that could hit American cities by 2015.
Four years later, when the United States was mired in the first year of the Iraq war, the council refined its prediction, saying a “crisis over North Korea is likely to come to a head sometime over the next 15 years,” that is, no later than 2019.
None of this was ignored. President George W. Bush began a program to interdict ships delivering material for the North’s weapons program, and he accelerated secret efforts to cripple the program by sabotaging its supply chain with bad parts.
But the C.I.A.’s main focus was on counterterrorism, and satellite coverage over North Korea was often diverted to keep troops safe in the Middle East.
The United States was surprised in 2006, when it received a heads-up about the North’s first underground nuclear test — from China, only about an hour before the explosion.
It was surprised again the next year when the head of the Mossad, Israel’s intelligence service, arrived at the White House with photographs showing a nuclear reactor under construction in Syria that matched the North’s Yongbyon reactor. One picture, eventually released by the C.I.A., showed the chief of North Korea’s nuclear-fuel production at the Syrian site. Though the plant was less than 100 miles from the Iraqi border, the United States had missed it.
In 2010, North Korea invited Siegfried S. Hecker, the former director of the Los Alamos National Laboratory, to visit and showed him a complete uranium-enrichment plant it had built inside an old building at Yongbyon. The Koreans had installed the facility, at a site under regular satellite surveillance, without being detected.
Intelligence officials said there were good reasons for this spotty record.
Foreign governments almost never succeed in recruiting North Korean scientists as sources because they are rarely allowed to go abroad. The North also appears to have figured out the patterns of some American spy satellites.
And while documents released by Edward J. Snowden showed the National Security Agency had penetrated North Korea, it is unclear whether its cybersnooping gleaned anything useful in a nation with minimal computer networking.

But in 2008, two years after its first nuclear test, Condoleezza Rice, then secretary of state, warned allies that the North was on the verge of another leap: A Soviet rocket engine representing “a substantial advance” had aided its development of longer-range missiles, according to a secret memo disclosed in 2010 by WikiLeaks.
Then, rather suddenly, the urgency seemed to recede.
When Mr. Kim came to power, many in the intelligence community doubted he would survive: He was young, inexperienced and distrusted by his military. And over the next four years, during Mr. Obama’s second term, North Korea’s missile program experienced repeated public failures, prompting more than a few jokes on late-night television in the United States.
The worst humiliation came in April 2012, two days after Mr. Kim’s formal elevation to the highest level of state power, on the 100th anniversary of his grandfather’s birthday. He marked the occasion with a satellite launch intended to demonstrate technology used in an intercontinental ballistic missile, and even invited foreign journalists. But the rocket shattered soon after launch and fell into the Yellow Sea.
By late 2013, the intelligence community had largely changed its view of Mr. Kim. He was eliminating his rivals, sometimes ordering public executions with antiaircraft guns that shredded their bodies. And he seemed far more serious about the nuclear and missile program.
His father and grandfather tested weapons to make a political point. Mr. Kim, however, turned the program into North Korea’s version of the Manhattan Project, the race to develop the atomic bomb in the United States. He made the development of a nuclear arsenal one of the state’s top priorities, on equal footing with economic development. Only with a nuclear deterrent, he argued, would the nation be secure enough to focus on growth.
It now appears that Mr. Kim had several missile programs underway simultaneously, and sped efforts to make parts and missile fuel indigenously, so that the United States and its allies could not cut off his supplies.
President Obama, increasingly concerned, ordered multiple reviews, including the one in early 2014 in which he authorized an intensification of covert cyberstrikes and electronic strikes on the North’s missile program.
The pace of missile tests accelerated, reaching a peak of more than two dozen in 2016. But at least 10 launches failed that year, including seven of an intermediate-range missile known as the Musudan.
Former senior officials in the Obama administration say it remains unclear whether the sabotage effort contributed to the failed tests; there are many alternative explanations. But this much is clear: In October 2016, Mr. Kim ordered a halt to the Musudan tests, and the missile program rapidly shifted in a different direction, focusing on a new generation of more reliable and potent engines.
In May, North Korea successfully tested the new design in an intermediate-range missile capable of hitting the American territory of Guam. Then, on July 4, it stunned the world with its first successful test of an ICBM — and repeated the success a few weeks later. In November, it tested a greatly improved ICBM, known as the Hwasong-15, that could fly about 8,100 miles, far enough to threaten all of the United States.
It was a remarkable sprint, and there was surprise inside the C.I.A. and other intelligence agencies. Mr. Kim appeared to have solved the problems that plagued the Musudan — and perhaps outmaneuvered the American sabotage program.
The latest missiles appeared to have been based on old Soviet designs. In interviews, intelligence officials said “freelancers” from the former Soviet Union — “a handful” by the estimate of one official — are almost certainly working with North Korea. The Russian government, they added, does not appear to be providing support.
Between the missile tests, in September, North Korea also detonated its most powerful underground nuclear blast yet. The North claimed it was a hydrogen bomb, and after initial skepticism, many experts now say it probably was.
Several officials who served under Mr. Obama said that was a real surprise; they had been told that moment was still years away.
Entering 2018, there are several disputes inside the intelligence world about the North’s capabilities.
Most intelligence agencies say the North has an arsenal of about 20 or 30 nuclear weapons, for example, but the Pentagon’s Defense Intelligence Agency puts the number above 50.
It is more than an academic argument. If Mr. Trump attempted to destroy the arsenal, or if the North Korean government collapsed, the challenge would be to neutralize the weapons without any launch taking place or any warhead falling into the wrong hands. The more there are, the more difficult that task becomes.
The intelligence agencies are also intently focused on not missing the next big milestone: the moment North Korea learns how to design and build a warhead that can survive the heat and stresses of re-entry into the atmosphere, continue to plunge downward and succeed in destroying its target.
When the United States built its nuclear arsenal in the 1950s and ’60s, that “was the hardest part for us,” said General Hyten of the United States Strategic Command.
Having underestimated the North, though, Washington now faces some risk of overstating its capabilities and intentions, some experts hold.
Dr. Hecker, the former director at Los Alamos, recently argued that North Korea needs “at least two more years and several more missile and nuclear tests” to perfect a weapon that can threaten American cities.
